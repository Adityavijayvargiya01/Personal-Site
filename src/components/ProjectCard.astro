---
import type { CollectionEntry } from 'astro:content'
import { Image } from 'astro:assets'
import { badgeVariants } from '@/components/ui/badge'
import { cn } from '@/lib/utils'
import { Icon } from 'astro-icon/components'
import { formatDate } from '@/lib/utils'

interface Props {
  project: CollectionEntry<'projects'>
}

const { project } = Astro.props
const { name, description, tags, image, link, startDate, endDate } = project.data

const dateRange = startDate
  ? `${formatDate(startDate)}${endDate ? ` - ${formatDate(endDate)}` : ' - Present'}`
  : null
---

<article class="transition-smooth group rounded-lg border-2 p-6 hover:border-primary/50">
  <div class="flex flex-col gap-4 md:flex-row">
    {image && (
      <div class="flex-shrink-0">
        <Image
          src={image}
          alt={name}
          width={120}
          height={120}
          class="rounded-lg object-cover"
        />
      </div>
    )}
    <div class="flex flex-1 flex-col gap-3">
      <div class="flex items-start justify-between gap-4">
        <div class="flex-1">
          <h3 class="text-xl font-semibold group-hover:text-primary transition-colors">
            {name}
          </h3>
          {dateRange && (
            <p class="text-muted-foreground text-xs mt-1">
              {dateRange}
            </p>
          )}
        </div>
        {link && (
          <a
            href={link}
            target="_blank"
            rel="noopener noreferrer"
            class="text-muted-foreground hover:text-primary transition-colors"
            aria-label={`View ${name}`}
          >
            <Icon name="ph:arrow-square-out" class="h-5 w-5" />
          </a>
        )}
      </div>
      <p class="text-muted-foreground text-sm leading-relaxed">
        {description}
      </p>
      {tags && tags.length > 0 && (
        <div class="flex flex-wrap gap-2">
          {tags.map((tag) => (
            <span
              class={cn(
                badgeVariants({ variant: 'secondary' }),
                'text-xs px-2.5 py-1'
              )}
            >
              {tag}
            </span>
          ))}
        </div>
      )}
    </div>
  </div>
</article>
